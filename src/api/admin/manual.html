<!DOCTYPE html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Program documentation</title>
</head>

<body>
	<h1>Generative Model Proxy Server</h1>
	<h2>Request Routing</h2>
	<p>Requests are routed to the following endpoints, in order of priority:</p>
	<ul>
		<li>/admin/ - <code>admin_router</code> endpoints
			<ul>
				<li>/{<a href="./users">users</a>|<a href="./roles">roles</a>|<a href="./models">models</a>|<a
						href="./quotas">quotas</a>}
					<ul>
						<li>GET /</li>
						<li>POST / - JSON body required</li>
						<li>PUT / - JSON body required</li>
						<li>GET /:uuid</li>
						<li>PUT /:uuid - JSON body required. Cannot be used to change the object's UUID.</li>
						<li>DELETE /:uuid</li>
					</ul>
				</li>
				<li>GET <a href="./manual">/manual</a></li>
				<li>GET <a href="./setup-instructions">/setup-instructions</a></li>
			</ul>
		</li>
		<li>/ - <code>model_request</code> endpoints (details omitted for brevity, see relevant section)
			<ul>
				<li>GET {endpoint}</li>
				<li>POST {endpoint} - JSON body or HTML Form data required</li>
			</ul>
		</li>
	</ul>
	<h2>Internal Objects</h2>
	<p>The following types of objects can be modified using the /admin/ API:</p>
	<ul>
		<li>User
			<ul>
				<li>label: String
					<ul>
						<li>A human-readable label for the object. Multiple objects may have the same label.</li>
						<li>default = ""</li>
					</ul>
				</li>
				<li>uuid: Uuid
					<ul>
						<li>Used as a reference to the object in logs, API calls, and from other objects (if
							applicable).</li>
						<li>A cryptographically hashed copy of the user's Uuid may be forwarded to model backends.</li>
						<li>default = Uuid::random()
							<ul>
								<li>Must be specified when creating an object via the PUT method</li>
							</ul>
						</li>
					</ul>
				</li>
				<li>admin: bool
					<ul>
						<li>Allows giving administrative access to the user. This allows <strong></strong>unrestricted
							access</strong> to the /admin/ API, along with giving access to all models.
						</li>
						<li>default = false</li>
					</ul>
				</li>
				<li>api_keys - []String
					<ul>
						<li>A list of API keys that the user can authenticate with.</li>
						<li>API keys should be randomly generated by the administrator. Having the same API key refer to
							multiple users will lead to inconsistent behavior.</li>
						<li>default = []</li>
					</ul>
				</li>
				<li>roles - []Uuid
					<ul>
						<li>A list of roles that the user should inherit models, quotas, and administrative status (if
							applicable) from.
						</li>
						<li>default = []</li>
					</ul>
				</li>
				<li>models - []Uuid
					<ul>
						<li>A list of models that the user should be able to access.</li>
						<li>default = []</li>
					</ul>
				</li>
				<li>quotas - []Uuid
					<ul>
						<li>A list of rate limiters that the user should be subject to.</li>
						<li>Rate limiters should be carefully managed by the administrator. Having a request subject to
							the same rate limiter multiple times (for example: specifying it twice in a User, or once in
							a User and once in a Role that User has) will lead to the request incrementing the rate
							limiter multiple times.</li>
						<li>default = []</li>
					</ul>
				</li>
			</ul>
		</li>
		<li>Role
			<ul>
				<li>label: String
					<ul>
						<li>A human-readable label for the object. Multiple objects may have the same label.</li>
						<li>default = ""</li>
					</ul>
				</li>
				<li>uuid: Uuid
					<ul>
						<li>Used as a reference to the object in logs, API calls, and from other objects (if
							applicable).</li>
						<li>default = Uuid::random()
							<ul>
								<li>Must be specified when creating an object via the PUT method</li>
							</ul>
						</li>
					</ul>
				</li>
				<li>admin: bool
					<ul>
						<li>Allows giving administrative access to all users with this role. This allows
							<strong></strong>unrestricted
							access</strong> to the /admin/ API, along with giving access to all models.
						</li>
						<li>default = false</li>
					</ul>
				</li>
				<li>models - []Uuid
					<ul>
						<li>A list of models that all users with this role should be able to access.</li>
						<li>default = []</li>
					</ul>
				</li>
				<li>quotas - []Uuid
					<ul>
						<li>A list of rate limiters that all users with this role should be subject to.</li>
						<li>Rate limiters should be carefully managed by the administrator. Having a request subject to
							the same rate limiter multiple times (for example: specifying it twice in a User, or once in
							a User and once in a Role that User has) will lead to the request incrementing the rate
							limiter multiple times.</li>
						<li>default = []</li>
					</ul>
				</li>
			</ul>
		</li>
		<li>Model
			<ul>
				<li>label: String
					<ul>
						<li>A human-readable label for the object. Multiple objects may have the same label.</li>
						<li>default = ""</li>
					</ul>
				</li>
				<li>uuid: Uuid
					<ul>
						<li>Used as a reference to the object in logs, API calls, and from other objects (if
							applicable).</li>
						<li>default = Uuid::random()
							<ul>
								<li>Must be specified when creating an object via the PUT method</li>
							</ul>
						</li>
					</ul>
				</li>
				<li>name: String
					<ul>
						<li>Used to refer to the model in API calls.</li>
						<li>Model names should be carefully managed by the administrator. Having the same name +
							ModelType refer to multiple models may lead to inconsistent behavior.</li>
						<li>required</li>
					</ul>
				</li>
				<li>types: []ModelType
					<ul>
						<li>required</li>
					</ul>
				</li>
				<li>api: ModelBackend
					<ul>
						<li>required</li>
					</ul>
				</li>
				<li>quotas - []Uuid
					<ul>
						<li>A list of rate limiters that all requests to this model should be subject to.</li>
						<li>Rate limiters should be carefully managed by the administrator. Having a request subject to
							the same rate limiter multiple times (for example: specifying it twice in a User, or once in
							a User and once in a Role that User has) will lead to the request incrementing the rate
							limiter multiple times.</li>
						<li>Note: Some model backends may perform rate limiting independently of this option, using
							information like HTTP headers from the backend.</li>
						<li>default = []</li>
					</ul>
				</li>
			</ul>
		</li>
		<li>Quota
			<ul>
				<li>label: String
					<ul>
						<li>A human-readable label for the object. Multiple objects may have the same label.</li>
						<li>default = ""</li>
					</ul>
				</li>
				<li>uuid: Uuid
					<ul>
						<li>Used as a reference to the object in logs, API calls, and from other objects (if
							applicable).</li>
						<li>default = Uuid::random()
							<ul>
								<li>Must be specified when creating an object via the PUT method</li>
							</ul>
						</li>
					</ul>
				</li>
				<li>limits: []Limit
					<ul>
						<li>required</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<h3>Internal Object Datatypes</h3>
	<ul>
		<li>bool</li>
		<li>String</li>
		<li>Uuid</li>
		<li>ModelType</li>
		<li>ModelBackend</li>
		<li>Limit</li>
		<li>LimiterState</li>
	</ul>
</body>
